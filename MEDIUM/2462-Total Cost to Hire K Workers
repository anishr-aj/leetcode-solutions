class Solution {
    public long totalCost(int[] costs, int k, int candidates) {
        int totalWorkers = costs.length;
        long totalHiringCost = 0;

        if (candidates * 2 >= totalWorkers) {
            Arrays.sort(costs);
            for (int i = 0; i < k; i++) {
                totalHiringCost += costs[i];
            }
            return totalHiringCost;
        }

        PriorityQueue<int[]> candidateHeap = new PriorityQueue<>((a, b) -> {
            if (a[0] == b[0]) {
                return a[1] - b[1];
            }
            return a[0] - b[0];
        });

        for (int i = 0; i < candidates; i++) {
            candidateHeap.offer(new int[] { costs[i], i });
        }

        for (int i = 0; i < candidates; i++) {
            candidateHeap.offer(new int[] { costs[totalWorkers - i - 1], totalWorkers - i - 1 });
        }

        int leftPointer = candidates;
        int rightPointer = totalWorkers - candidates - 1;

        while (k > 0) {
            int[] cheapestCandidate = candidateHeap.poll();
            totalHiringCost += cheapestCandidate[0];

            if (leftPointer > rightPointer) {
                k--;
                continue;
            }

            if (cheapestCandidate[1] < leftPointer) {
                candidateHeap.offer(new int[] { costs[leftPointer], leftPointer });
                leftPointer++;
            } else {
                candidateHeap.offer(new int[] { costs[rightPointer], rightPointer });
                rightPointer--;
            }

            k--;
        }

        return totalHiringCost;
    }
}
